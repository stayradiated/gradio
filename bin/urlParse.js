// Generated by CoffeeScript 1.6.2
/**
 * @fileOverview Parses a URL and detects what type it is (album, playlist,
 * artist) and it's ID.
*/


(function() {
  var parse, regex;

  regex = {
    domain: /^(https?:\/\/)?grooveshark\.com/,
    collection: /\/#!\/(album|artist|tag|playlist|user)\/[A-Za-z0-9\+_]+\/(\d+)\/?$/,
    user: /\/#!\/([A-Za-z-0-9_]+)\/?$/,
    search: /\#\!\/search\?q=([A-Za-z0-9\+\%\!\*\(\)\_\-\'\.\~]+)\/?$/
  };

  parse = function(url) {
    var collection, id, query, search, type, user;

    if (url.match(regex.domain) == null) {
      return ['err_url'];
    }
    collection = url.match(regex.collection);
    if (collection != null) {
      type = collection[1];
      id = collection[2];
      return [type, id];
    }
    user = url.match(regex.user);
    if (user != null) {
      user = user[1];
      return ['username', user];
    }
    search = url.match(regex.search);
    if (search != null) {
      query = search[1];
      query = query.replace(/\+/g, '%20');
      query = decodeURIComponent(query);
      return ['search', query];
    }
    return ['err_url'];
  };

  module.exports = parse;

}).call(this);
